# music-library-manager
Playlist/queue manager for Spotify and Apple Music


# Running the application
We reccomend running the applicaiton within docker containers. 
The docker-compose.yml file in the root of the project directory contains most of the configuration needed to get the containers working.

## Service Consumer Configuration
When deploying in a container, the environment variables `VITE_REGISTRY_URL` and `VITE_CONSUMER_URL` must be supplied.

- `VITE_REGISTRY_URL` refers to the url where the registry can be reached, including port numbers.

- `VITE_CONSUMER_URL` needs to be set to the url of the consumer including port numbers.

Vercel uses port 3000 for hosting by default.
The container remaps this to port 80.
So this container can be reached at [https://localhost](https://localhost)

## Service Registry Configuration
The service registry is very straightforward, the container must be run with the port 3000 exposed.

## Service Consumers Configuration
Each of the consumers have a `.env` file, and they also get some environment variables from docker compose. 

- `PROVIDER_URL` needs to be set to the url of the respective provider.

- `REGISTRY_URL` needs to be set to the url of the registry.


### Apple Consumer Configuration
`service-providers/apple-music-provider/.env`:
~~~env
APPLE_BEARER=<apple developer bearer token>
~~~

Apple bearer is a JWT generated by following [this guide](https://developer.apple.com/documentation/applemusicapi/generating_developer_tokens)

### Spotify Consumer Configuration
`service-providers/spotify-music-provider/.env`:
~~~env
CLIENT_ID=<spotify client id>
CLIENT_SECRET=<spotify client secret>
~~~

The spotify client id and secret were obtained by creating an app on spotify. [API docs](https://developer.spotify.com/documentation/web-api/concepts/apps)

## Start the app
The docker compose can be used by running
~~~bash
docker compose up
~~~
in the root directory. Then the consumer will be available at [https://localhost](https://localhost)

# Development
## Consumer development
.env variables should be prefixed with VITE_variable_name
To use an environment variable in the Vue project we can use import.meta.env.VITE_VARIABLE_NAME

For development, a `.env` file needs to be created.
The `.env.example` file should be the correct configuration for deploying locally.

~~~bash
cd service-consumer
cp .env.example .env
~~~

Then to run vite use
~~~bash
cd service-consumer
npm run dev
~~~
